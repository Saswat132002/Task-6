
-- Create the 'orders' table
DROP TABLE IF EXISTS orders;

CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    order_date DATE,
    revenue DECIMAL(10, 2)
);

-- Insert 100 rows of sample data
INSERT INTO orders (order_id, order_date, revenue) VALUES
(1, '2023-01-05', 120.50), (2, '2023-01-15', 340.00), (3, '2023-01-20', 89.99),
(4, '2023-02-02', 450.75), (5, '2023-02-11', 215.60), (6, '2023-02-20', 135.20),
(7, '2023-03-03', 99.99), (8, '2023-03-14', 180.00), (9, '2023-03-25', 210.30),
(10, '2023-03-30', 500.00), (11, '2023-04-01', 300.00), (12, '2023-04-08', 125.75),
(13, '2023-04-15', 325.25), (14, '2023-04-28', 400.40), (15, '2023-05-03', 220.00),
(16, '2023-05-10', 199.99), (17, '2023-05-17', 350.50), (18, '2023-05-25', 185.30),
(19, '2023-06-01', 275.00), (20, '2023-06-08', 140.60), (21, '2023-06-15', 390.20),
(22, '2023-06-21', 305.99), (23, '2023-06-29', 500.00), (24, '2023-07-04', 180.10),
(25, '2023-07-11', 245.00), (26, '2023-07-19', 399.99), (27, '2023-07-26', 320.00),
(28, '2023-08-02', 215.75), (29, '2023-08-09', 185.99), (30, '2023-08-17', 430.25),
(31, '2023-08-24', 160.00), (32, '2023-08-30', 290.40), (33, '2023-09-05', 300.00),
(34, '2023-09-12', 200.00), (35, '2023-09-19', 405.55), (36, '2023-09-28', 499.99),
(37, '2023-10-01', 310.20), (38, '2023-10-07', 280.40), (39, '2023-10-13', 225.30),
(40, '2023-10-20', 150.50), (41, '2023-10-29', 330.70), (42, '2023-11-03', 299.99),
(43, '2023-11-10', 275.25), (44, '2023-11-17', 360.00), (45, '2023-11-24', 405.90),
(46, '2023-11-30', 320.00), (47, '2023-12-04', 215.60), (48, '2023-12-10', 190.00),
(49, '2023-12-18', 440.45), (50, '2023-12-25', 375.00), (51, '2023-01-08', 199.00),
(52, '2023-01-16', 150.00), (53, '2023-01-24', 310.20), (54, '2023-01-29', 500.00),
(55, '2023-02-05', 180.30), (56, '2023-02-13', 280.40), (57, '2023-02-22', 135.99),
(58, '2023-03-01', 390.60), (59, '2023-03-10', 220.50), (60, '2023-03-22', 310.20),
(61, '2023-04-02', 400.00), (62, '2023-04-11', 275.00), (63, '2023-04-18', 150.90),
(64, '2023-04-27', 199.99), (65, '2023-05-04', 275.60), (66, '2023-05-12', 190.10),
(67, '2023-05-19', 340.00), (68, '2023-06-03', 399.99), (69, '2023-06-11', 210.30),
(70, '2023-06-18', 405.00), (71, '2023-07-01', 215.75), (72, '2023-07-08', 185.50),
(73, '2023-07-16', 350.25), (74, '2023-08-05', 300.00), (75, '2023-08-13', 140.20),
(76, '2023-08-21', 280.00), (77, '2023-09-01', 199.99), (78, '2023-09-09', 315.60),
(79, '2023-09-17', 225.90), (80, '2023-10-03', 330.00), (81, '2023-10-11', 250.00),
(82, '2023-10-18', 175.99), (83, '2023-11-05', 199.00), (84, '2023-11-13', 180.00),
(85, '2023-11-21', 270.30), (86, '2023-12-02', 325.25), (87, '2023-12-09', 399.99),
(88, '2023-12-15', 215.00), (89, '2023-12-23', 199.50), (90, '2023-12-31', 500.00),
(91, '2023-01-02', 199.99), (92, '2023-02-03', 150.00), (93, '2023-03-06', 220.00),
(94, '2023-04-04', 290.00), (95, '2023-05-06', 370.00), (96, '2023-06-07', 310.00),
(97, '2023-07-09', 260.00), (98, '2023-08-11', 190.00), (99, '2023-09-13', 330.00),
(100, '2023-10-15', 410.00);

-- Aggregation Query
SELECT
    EXTRACT(YEAR FROM order_date) AS order_year,
    EXTRACT(MONTH FROM order_date) AS order_month,
    COUNT(DISTINCT order_id) AS order_volume,
    SUM(revenue) AS total_revenue
FROM
    orders
WHERE
    order_date >= DATE '2023-01-01' AND order_date < DATE '2024-01-01'
GROUP BY
    EXTRACT(YEAR FROM order_date),
    EXTRACT(MONTH FROM order_date)
ORDER BY
    order_year,
    order_month;
